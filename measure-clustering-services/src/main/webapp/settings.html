<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>M·Elki</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.0/css/bootstrap.min.css">
  </head>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.0/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/rivets/0.9.6/rivets.bundled.min.js"></script>
  <body>
    <div class="bg-light">
      <div class="container-fluid">
        <h2 class="display-4">M·ELKI <!-- img src="https://elki-project.github.io/img/elk200.png" alt="ELKI" height="60" width="60" / --></h2>
        <p class="lead">Clustering Algorithms dedicated to the MEASURE Platform and based on the ELKI Java Library</p>
      </div>
    </div>
    <section id="content" class="container-fluid">
      <div class="row">
      <div class="col">
        <div class="list-group">
          <div class="list-group-item">
            <h5 class="list-group-item-heading">DBScan</h5>
            <ul class="list-group-item-text">
              <li>distance: {dbscan.data.distance.name}</li>
              <li>epsilon: {dbscan.data.epsilon}</li>
              <li>size: {dbscan.data.size}</li>
            </ul>
            <p class="list-group-item-text text-right">
              <button class="btn btn-outline-primary" rv-on-click="dbscan.select">Select</button>
            </p>
          </div>
          <div class="list-group-item">
            <h5 class="list-group-item-heading">KMeans</h5>
            <ul class="list-group-item-text">
              <li>distance: {kmeans.data.distance.name}</li>
              <li>length: {kmeans.data.length}</li>
              <li>limit: {kmeans.data.limit}</li>
            </ul>
            <p class="list-group-item-text text-right">
              <button class="btn btn-outline-primary" rv-on-click="kmeans.select">Select</button>
            </p>
          </div>
          <div class="list-group-item">
            <h5 class="list-group-item-heading">EM</h5>
            <ul class="list-group-item-text">
              <li>length: {em.data.length}</li>
              <li>delta: {em.data.delta}</li>
              <li>limit: {em.data.limit}</li>
            </ul>
            <p class="list-group-item-text text-right">
              <button class="btn btn-outline-primary" rv-on-click="em.select">Select</button>
            </p>
          </div>
          <div class="list-group-item">
            <h5 class="list-group-item-heading">SLink</h5>
            <ul class="list-group-item-text">
              <li>distance: {slink.data.distance.name}</li>
              <li>size: {slink.data.size}</li>
            </ul>
            <p class="list-group-item-text text-right">
              <button class="btn btn-outline-primary" rv-on-click="slink.select">Select</button>
            </p>
          </div>
        </div>
      </div>
      <div class="col">
        <form class="form" role="form" name="dbscanForm" rv-show="dbscan.selected">
          <fieldset>
            <legend>Configuring DBScan</legend>
            <div class="form-group">
              <label for="dbscan.epsilon">Epsilon</label>
              <input type="number" step="0.1" id="dbscan.epsilon" class="form-control" rv-value="dbscan.copy.epsilon" placeholder="Epsilon" required />
            </div>
            <div class="form-group">
              <label for="dbscan.size">Size</label>
              <input type="number" step="1" id="dbscan.size" class="form-control" rv-value="dbscan.copy.size" placeholder="Size" required />
            </div>
            <div class="form-group">
              <label for="dbscan.distance">Distance Function</label>
              <select id="dbscan.distance" class="form-control" rv-on-change="dbscan.distance" placeholder="Distance Function" required>
                <option rv-each-distance="distances" rv-value="distance.id" rv-text="distance.name"></option>
              </select>
            </div>
            <div class="form-group text-right">
               <button type="button" class="btn btn-outline-danger" rv-on-click="clear">Cancel</button>
               <button type="button" class="btn btn-outline-dark" rv-on-click="dbscan.select">Reset</button>
               <button type="button" class="btn btn-primary" rv-on-click="dbscan.put">Submit</button>
             </div>
          </fieldset>
        </form>
        <form class="form" role="form" name="kmeansForm" rv-show="kmeans.selected">
          <fieldset>
            <legend>Configuring KMeans</legend>
            <div class="form-group">
              <label for="kmeans.data.length">Length</label>
              <input type="number" step="1" id="kmeans.data.length" class="form-control" rv-value="kmeans.copy.length" placeholder="Length" required />
            </div>
            <div class="form-group">
              <label for="kmeans.data.limit">Limit</label>
              <input type="number" step="1" id="kmeans.data.limit" class="form-control" rv-value="kmeans.copy.limit" placeholder="Limit" required />
            </div>
            <div class="form-group">
              <label for="kmeans.data.distance">Distance Function</label>
              <select id="kmeans.data.distance" class="form-control" rv-on-change="kmeans.distance" placeholder="Distance Function" required>
                <option rv-each-distance="distances" rv-value="distance.id" rv-text="distance.name"></option>
              </select>
            </div>
            <div class="form-group text-right">
               <button type="button" class="btn btn-outline-danger" rv-on-click="clear">Cancel</button>
               <button type="button" class="btn outline-dark" rv-on-click="kmeans.select">Reset</button>
               <button type="button" class="btn btn-primary" rv-on-click="kmeans.put">Submit</button>
             </div>
          </fieldset>
        </form>
        <form class="form" role="form" name="emForm" rv-show="em.selected">
          <fieldset>
            <legend>Configuring EM</legend>
            <div class="form-group">
              <label for="em.data.delta">Delta</label>
              <input type="number" step="1.0" id="em.data.delta" class="form-control" rv-value="em.copy.delta" placeholder="Delta" required />
            </div>
            <div class="form-group">
              <label for="em.data.length">Length</label>
              <input type="number" step="1" id="em.data.length" class="form-control" rv-value="em.copy.length" placeholder="Length" required />
            </div>
            <div class="form-group">
              <label for="em.data.limit">Limit</label>
              <input type="number" step="1" id="em.data.limit" class="form-control" rv-value="em.copy.limit" placeholder="Limit" required />
            </div>
            <div class="form-group text-right">
               <button type="button" class="btn btn-outline-danger" rv-on-click="clear">Cancel</button>
               <button type="button" class="btn btn-outline-dark" rv-on-click="em.select">Reset</button>
               <button type="button" class="btn btn-primary" rv-on-click="em.put">Submit</button>
             </div>
          </fieldset>
        </form>
        <form class="form" role="form" name="slinkForm" rv-show="slink.selected">
          <fieldset>
            <legend>Configuring SLink</legend>
            <div class="form-group">
              <label for="slink.data.size">Size</label>
              <input type="number" step="1" id="slink.data.size" class="form-control" rv-value="slink.copy.size" placeholder="Size" required />
            </div>
            <div class="form-group">
              <label for="slink.data.distance">Distance Function</label>
              <select id="slink.data.distance" class="form-control" rv-on-change="slink.distance" placeholder="Distance Function" required>
               <option rv-each-distance="distances" rv-value="distance.id" rv-text="distance.name"></option>
              </select>
            </div>
            <div class="form-group text-right">
               <button type="button" class="btn btn-outline-danger" rv-on-click="clear">Cancel</button>
               <button type="button" class="btn btn-outline-dark" rv-on-click="slink.select">Reset</button>
               <button type="button" class="btn btn-primary" rv-on-click="slink.put">Submit</button>
             </div>
          </fieldset>
        </form>
      </div>
      </div>
    </section>
  </body>
  <script type="text/javascript">
  var id = 0;
  var identifier = function() {
    var query = window.location.search;
    var items = query.substring(1).split("&");
    items.forEach(function(item) {
    	var pair = item.split("=");
    	if (pair[0] == "id") {
    		id = pair[1];
    	}
    });
  };
  identifier();
  
  var elki = {};
  elki.get = {};
  elki.put = {};
  elki.post = {};
  
  elki.get.distances = function(onSuccess, onError) {
    const req = new XMLHttpRequest();
	  req.onload = function(event) {
	  if (this.status === 200) {
	    onSuccess(JSON.parse(this.responseText));
	  } else {
		onError(JSON.parse(this.responseText));
	  }
	};
	req.onerror = function(event) {
	  onError(JSON.parse(this.responseText));
	}
	req.open('GET','/elki/distances', true);
	req.send(null);
  };
	    
  elki.get.dbscan = function(onSuccess, onError) {
    const req = new XMLHttpRequest();
    req.onload = function(event) {
      if (this.status === 200) {
        onSuccess(JSON.parse(this.responseText));
      } else {
    	onError(JSON.parse(this.responseText));
      }
    };
    req.onerror = function(event) {
      onError(JSON.parse(this.responseText));
    }
    req.open('GET','/elki/dbscan?id=' + id, true);
    req.send(null);    
  };
	    
  elki.get.kmeans = function(onSuccess, onError) {
    const req = new XMLHttpRequest();
    req.onload = function(event) {
      if (this.status === 200) {
        onSuccess(JSON.parse(this.responseText));
      } else {
    	onError(JSON.parse(this.responseText));
      }
    };
    req.onerror = function(event) {
      onError(JSON.parse(this.responseText));
    }
    req.open('GET','/elki/kmeans?id=' + id, true);
    req.send(null);    
  };
	    
  elki.get.em = function(onSuccess, onError) {
    const req = new XMLHttpRequest();
    req.onload = function(event) {
      if (this.status === 200) {
        onSuccess(JSON.parse(this.responseText));
      } else {
    	onError(JSON.parse(this.responseText));
      }
    };
    req.onerror = function(event) {
      onError(JSON.parse(this.responseText));
    }
    req.open('GET','/elki/em?id=' + id, true);
    req.send(null);    
  };
	    
  elki.get.slink = function(onSuccess, onError) {
    const req = new XMLHttpRequest();
    req.onload = function(event) {
      if (this.status === 200) {
        onSuccess(JSON.parse(this.responseText));
      } else {
    	onError(JSON.parse(this.responseText));
      }
    };
    req.onerror = function(event) {
      onError(JSON.parse(this.responseText));
    }
    req.open('GET','/elki/slink?id=' + id, true);
    req.send(null);    
  };

  elki.put.dbscan = function(data, onSuccess, onError) {
	const parameters = "&" + "distance=" + data.distance.id + "&" + "epsilon=" + data.epsilon + "&" + "size=" + data.size;
    const req = new XMLHttpRequest();
    req.onload = function(event) {
      if (this.status === 200) {
        onSuccess(JSON.parse(this.responseText));
      } else {
    	onError(JSON.parse(this.responseText));
      }
    };
    req.onerror = function(event) {
      onError(JSON.parse(this.responseText));
    }
    req.open('PUT','/elki/dbscan?id=' + id + parameters, true);
    req.send(null);
  };

  elki.put.kmeans = function(data, onSuccess, onError) {
	const parameters = "&" + "distance=" + data.distance.id + "&" + "length=" + data.length + "&" + "limit=" + data.limit;
    const req = new XMLHttpRequest();
    req.onload = function(event) {
      if (this.status === 200) {
        onSuccess(JSON.parse(this.responseText));
      } else {
    	onError(JSON.parse(this.responseText));
      }
    };
    req.onerror = function(event) {
      onError(JSON.parse(this.responseText));
    }
    req.open('PUT','/elki/kmeans?id=' + id + parameters, true);
    req.send(null);
  };

  elki.put.em = function(data, onSuccess, onError) {
	const parameters = "&" + "length=" + data.length + "&" + "delta=" + data.delta + "&" + "limit=" + data.limit;
    const req = new XMLHttpRequest();
    req.onload = function(event) {
      if (this.status === 200) {
        onSuccess(JSON.parse(this.responseText));
      } else {
    	onError(JSON.parse(this.responseText));
      }
    };
    req.onerror = function(event) {
      onError(JSON.parse(this.responseText));
    }
    req.open('PUT','/elki/em?id=' + id + parameters, true);
    req.send(null);
  };

  elki.put.slink = function(data, onSuccess, onError) {
	const parameters = "&" + "distance=" + data.distance.id + "&" + "size=" + data.size;
    const req = new XMLHttpRequest();
    req.onload = function(event) {
      if (this.status === 200) {
        onSuccess(JSON.parse(this.responseText));
      } else {
    	onError(JSON.parse(this.responseText));
      }
    };
    req.onerror = function(event) {
      onError(JSON.parse(this.responseText));
    }
    req.open('PUT','/elki/slink?id=' + id + parameters, true);
    req.send(null);
  };
  </script>
  <script type="text/javascript">
  
  var content = {};
  rivets.bind($('#content'), content);
  
  content.distances = [];
  content.dbscan = {};
  content.kmeans = {};
  content.em = {};
  content.slink = {};
  
  var distances = function() {
    elki.get.distances(function onSuccess(response){
      content.distances = response;
    },function onError(response) {
      content.distances = [];
    });
  };
    
  content.dbscan.get = function() {
    elki.get.dbscan(function onSuccess(response){
      content.dbscan.data = response;
	},function onError(response){
	  content.dbscan.data = {};
	});
  };
  
  content.dbscan.put = function() { 
    elki.put.dbscan(content.dbscan.copy, function onSuccess(response){
      content.clear();	
      content.dbscan.get();
	},function onError(response){
      content.clear();
      content.dbscan.get();
	});
  };
    
  content.kmeans.get = function() {
    elki.get.kmeans(function onSuccess(response){
      content.kmeans.data = response;
	},function onError(response){
	  content.kmeans.data = {};
	});
  };

  content.kmeans.put = function() { 
    elki.put.kmeans(content.kmeans.copy, function onSuccess(response){
      content.clear();	
      content.kmeans.get();
	},function onError(response){
      content.clear();
      content.kmeans.get();
	});
  };
  
  content.em.get = function() {
    elki.get.em(function onSuccess(response){
      content.em.data = response;
	},function onError(response){
	  content.em.data = {};
	});
  };

  content.em.put = function() { 
    elki.put.em(content.em.copy, function onSuccess(response){
      content.clear();	
      content.em.get();
	},function onError(response){
      content.clear();
      content.em.get();
	});
  };
  
  content.slink.get = function() {
    elki.get.slink(function onSuccess(response){
      content.slink.data = response;
	},function onError(response){
	  content.slink.data = {};
	});
  };

  content.slink.put = function() { 
    elki.put.slink(content.slink.copy, function onSuccess(response){
      content.clear();	
      content.slink.get();
	},function onError(response){
      content.clear();
      content.slink.get();
	});
  };
    
  distances();
  content.dbscan.get();
  content.kmeans.get();
  content.em.get();
  content.slink.get();
  
  content.clear = function () {
    content.dbscan.selected = false;
    content.kmeans.selected = false;
    content.em.selected = false;
    content.slink.selected = false;	  
  };
  
  content.dbscan.distance = function(event) {
	content.distances.forEach(function (d) {
	  if (d.id == event.target.value) {
		content.dbscan.copy.distance = jQuery.extend(true, {}, d);
	  }
	});
  };
  
  content.kmeans.distance = function(event) {
	content.distances.forEach(function (d) {
	  if (d.id == event.target.value) {
		content.kmeans.copy.distance = jQuery.extend(true, {}, d);
	  }
	});
  };
  
  content.slink.distance = function(event) {
	content.distances.forEach(function (d) {
	  if (d.id == event.target.value) {
		content.slink.copy.distance = jQuery.extend(true, {}, d);
	  }
	});
  };
  
  content.dbscan.select = function() {
    content.clear();
    content.dbscan.copy = jQuery.extend(true, {}, content.dbscan.data);
    content.dbscan.selected = true;
  };
  
  content.kmeans.select = function() {
    content.clear();
    content.kmeans.copy = jQuery.extend(true, {}, content.kmeans.data);
    content.kmeans.selected = true;
  };
  
  content.em.select = function() {
    content.clear();
    content.em.copy = jQuery.extend(true, {}, content.em.data);
    content.em.selected = true;
  };
  
  content.slink.select = function() {
    content.clear();
    content.slink.copy = jQuery.extend(true, {}, content.slink.data);
    content.slink.selected = true;
  };
  </script>
</html>
